<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AVZ PropTech - GPS com Antecipação de Recebíveis</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --black: #0a0a0a; --dark-black: #000000;
      --gold: #d4af37; --light-gold: #f4e4bc;
      --rose-gold: #e8b4b8; --white: #ffffff;
      --green: #4caf50; --red: #f44336;
      --rose-shadow: rgba(232, 180, 184, 0.5);
    }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #000 0%, #111 50%, #000 100%);
      color: var(--white); 
      display: flex; 
      flex-direction: column;
      align-items: center; 
      min-height: 100vh; 
      padding: 20px;
    }
    header { 
      width: 100%; 
      padding: 15px 0; 
      display: flex; 
      justify-content: center;
      background: rgba(0,0,0,0.6); 
      position: sticky; 
      top: 0; 
      z-index: 10; 
    }
    nav { 
      display: flex; 
      gap: 15px; 
      flex-wrap: wrap; 
      justify-content: center; 
      align-items: center;
    }
    nav a { 
      color: var(--white); 
      text-decoration: none; 
      font-weight: 500; 
      transition: 0.3s; 
      cursor: pointer; 
      padding: 8px 12px;
      border-radius: 6px;
    }
    nav a:hover { 
      color: var(--gold); 
      background: rgba(212, 175, 55, 0.1);
      box-shadow: 0 0 10px var(--rose-shadow);
    }
    h1 { 
      font-family: 'Playfair Display', serif; 
      font-size: 2.5rem; 
      margin: 20px 0;
      background: linear-gradient(135deg, var(--gold), var(--rose-gold));
      -webkit-background-clip: text; 
      -webkit-text-fill-color: transparent; 
      text-align: center;
    }
    p.subtitle { 
      font-size: 1.2rem; 
      color: rgba(255,255,255,0.8); 
      margin-bottom: 30px; 
      text-align: center;
      max-width: 600px;
      line-height: 1.5;
    }
    .main-btn { 
      display: inline-block; 
      background: linear-gradient(135deg, var(--gold), var(--light-gold));
      color: var(--black); 
      font-size: 1.2rem; 
      font-weight: bold; 
      padding: 15px 35px;
      border-radius: 50px; 
      text-decoration: none; 
      margin-bottom: 30px; 
      transition: 0.3s; 
      cursor: pointer;
      box-shadow: 0 8px 20px var(--rose-shadow); 
      text-align: center;
    }
    .main-btn:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 12px 28px var(--rose-shadow), 0 0 15px var(--rose-shadow); 
    }
    .divider { 
      width: 80%; 
      max-width: 600px;
      height: 2px; 
      margin: 20px auto;
      background: linear-gradient(90deg, var(--rose-gold), var(--gold), var(--rose-gold));
      border-radius: 2px; 
    }
    footer { 
      margin-top: 40px; 
      padding: 15px 0; 
      font-size: 0.85rem; 
      color: rgba(255,255,255,0.6); 
      text-align: center; 
      width: 100%;
    }

    /* Conteúdo Principal */
    .content {
      text-align: left;
      max-width: 1000px;
      width: 100%;
      margin: 20px 0;
    }

    .hero-section {
      text-align: center;
      padding: 40px 20px;
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      border: 1px solid var(--gold);
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: var(--gold);
      margin: 25px 0 15px 0;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(212, 175, 55, 0.3);
    }
    
    .section-content {
      margin-bottom: 25px;
      line-height: 1.6;
    }
    
    .section-content p {
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.85);
    }
    
    .highlight-box {
      background: rgba(212, 175, 55, 0.1);
      border-left: 4px solid var(--gold);
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }

    /* Como Funciona */
    .how-it-works {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
    }
    
    .step-card {
      flex: 1;
      min-width: 250px;
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      text-align: center;
    }
    
    .step-number {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--gold), var(--light-gold));
      color: var(--black);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-weight: bold;
    }
    
    .step-title {
      font-weight: 600;
      color: var(--gold);
      margin-bottom: 10px;
    }

    /* Calculadora de Antecipação */
    .calculator {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--light-gold);
    }
    
    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #222;
      color: white;
      font-size: 1rem;
      transition: all 0.3s;
    }
    
    .form-group input:focus {
      outline: none;
      border-color: var(--rose-gold);
      box-shadow: 0 0 10px var(--rose-shadow);
    }
    
    .calculate-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--gold), var(--light-gold));
      color: var(--black);
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 1.1rem;
      box-shadow: 0 6px 15px var(--rose-shadow);
      margin-bottom: 20px;
    }
    
    .calculate-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px var(--rose-shadow);
    }
    
    .result-box {
      background: rgba(0, 0, 0, 0.3);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      text-align: center;
    }
    
    .result-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--light-gold);
      margin: 10px 0;
    }

    /* Termos de Uso */
    .terms-container {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .terms-text {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.5;
    }

    /* Layout Principal */
    main {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 1200px;
    }

    /* Informações de Resgate */
    .withdrawal-info {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .info-card {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 20px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      text-align: center;
    }
    
    .info-card h3 {
      color: var(--gold);
      margin-bottom: 15px;
    }
    
    .warning-box {
      background: rgba(244, 67, 54, 0.1);
      border-left: 4px solid var(--red);
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }
    
    .benefits-list {
      list-style-type: none;
      margin: 20px 0;
    }
    
    .benefits-list li {
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
    }
    
    .benefits-list li i {
      color: var(--gold);
      margin-right: 10px;
    }
    
    .progress-container {
      width: 100%;
      height: 20px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      margin: 20px 0;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--gold), var(--rose-gold));
      border-radius: 10px;
      width: 0%;
      transition: width 0.5s ease;
    }
    
    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .info-row:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    /* Modal de Login/Registro */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 100;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: rgba(30, 30, 30, 0.95);
      border-radius: 15px;
      padding: 30px;
      border: 2px solid var(--gold);
      width: 90%;
      max-width: 450px;
      position: relative;
    }
    
    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: var(--white);
      font-size: 1.5rem;
      cursor: pointer;
    }
    
    .auth-form {
      margin-top: 20px;
    }
    
    .auth-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(212, 175, 55, 0.3);
    }
    
    .auth-tab {
      padding: 10px 20px;
      cursor: pointer;
      opacity: 0.7;
      transition: 0.3s;
    }
    
    .auth-tab.active {
      opacity: 1;
      border-bottom: 2px solid var(--gold);
      color: var(--gold);
    }
    
    .auth-form-content {
      display: none;
    }
    
    .auth-form-content.active {
      display: block;
    }
    
    .form-footer {
      margin-top: 20px;
      text-align: center;
      font-size: 0.9rem;
    }

    /* Pagamento */
    .payment-container {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
      display: none;
    }
    
    .payment-options {
      display: flex;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    
    .payment-option {
      flex: 1;
      min-width: 120px;
      padding: 15px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .payment-option:hover, .payment-option.selected {
      background: rgba(212, 175, 55, 0.1);
      border-color: var(--gold);
    }
    
    .payment-form {
      margin-top: 20px;
      display: none;
    }
    
    .card-element {
      background: #222;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #444;
      margin-bottom: 20px;
    }

    /* Dashboard */
    .dashboard {
      display: none;
      width: 100%;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <a style="color: var(--gold);"><i class="fas fa-map-marked-alt"></i> GPS com Antecipação</a>
      <a onclick="showAuthModal()" id="login-link"><i class="fas fa-user"></i> Entrar</a>
      <a onclick="showDashboard()" id="dashboard-link" style="display: none;"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
      <a onclick="logout()" id="logout-link" style="display: none;"><i class="fas fa-sign-out-alt"></i> Sair</a>
    </nav>
  </header>

  <main>
    <h1>AVZ PropTech</h1>
    <p class="subtitle">GPS Premium com Antecipação de Recebíveis</p>
    
    <div class="hero-section">
      <h2 style="font-family: 'Playfair Display', serif; margin-bottom: 20px; color: var(--gold);">
        Transforme seus trajetos em rendimentos
      </h2>
      <p style="font-size: 1.1rem; margin-bottom: 25px; max-width: 800px; margin-left: auto; margin-right: auto;">
        Use nosso GPS premium e receba antecipação de recebíveis com retorno garantido. 
        Contribua para projetos sustentáveis và receba benefícios diários.
      </p>
      <a class="main-btn" onclick="showCalculator()">
        <i class="fas fa-calculator"></i> Calcular Antecipação
      </a>
    </div>

    <div class="content">
      <h2 class="section-title">Como Funciona</h2>
      <div class="how-it-works">
        <div class="step-card">
          <div class="step-number">1</div>
          <div class="step-title">Calcule sua Antecipação</div>
          <p>Informe seus dados e veja quanto poderá receber.</p>
        </div>
        
        <div class="step-card">
          <div class="step-number">2</div>
          <div class="step-title">Desbloqueie o GPS</div>
          <p>Concorde com os termos e desbloqueie o sistema.</p>
        </div>
        
        <div class="step-card">
          <div class="step-number">3</div>
          <div class="step-title">Use e Ganhe</div>
          <p>Use o GPS diariamente e acumule rendimentos.</p>
        </div>
        
        <div class="step-card">
          <div class="step-number">4</div>
          <div class="step-title">Resgate seus Ganhos</div>
          <p>Resgate a partir de R$ 100,00 a qualquer momento.</p>
        </div>
      </div>

      <div class="divider"></div>

      <h2 class="section-title">Calculadora de Antecipação</h2>
      <div class="calculator" id="calculator">
        <div class="form-group">
          <label for="contribution-value">Valor da Contribuição (mínimo R$ 100,00):</label>
          <input type="number" id="contribution-value" placeholder="Ex: 500.00" min="100">
        </div>
        
        <div class="form-group">
          <label for="usage-days">Dias de Uso do GPS por Semana (1-7):</label>
          <input type="number" id="usage-days" placeholder="Ex: 5" min="1" max="7">
        </div>
        
        <button class="calculate-btn" onclick="calculateEarnings()">
          <i class="fas fa-calculator"></i> Calcular Projeção de Ganhos
        </button>
        
        <div class="result-box" id="result-box" style="display: none;">
          <h3>Sua Projeção de Ganhos</h3>
          <div class="info-row">
            <span>Valor Contribuído:</span>
            <span id="contribution-display">R$ 0,00</span>
          </div>
          <div class="info-row">
            <span>Retorno Mensal Estimado:</span>
            <span id="monthly-return">R$ 0,00</span>
          </div>
          <div class="info-row">
            <span>Retorno Total Estimado (6 meses):</span>
            <span id="total-return">R$ 0,00</span>
          </div>
          <div class="info-row">
            <span>Porcentagem de Retorno:</span>
            <span id="return-percentage">0%</span>
          </div>
          
          <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
            <span class="progress-text" id="progress-text">0%</span>
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <h2 class="section-title">Termos de Uso e Desbloqueio</h2>
      <div class="terms-container" id="terms-container" style="display: none;">
        <p class="terms-text">
          Ao aceitar, você concorda em utilizar o GPS da AVZ PropTech para fins de monitoramento de rotas e contribuição para a otimização logística de projetos sustentáveis. 
          A antecipação de recebíveis será creditada diariamente com base no uso do aplicativo. 
          O valor mínimo para resgate é de R$ 100,00. 
          A AVZ PropTech se reserva o direito de alterar os termos e condições mediante aviso prévio. 
          Seu uso do aplicativo será monitorado para garantir a conformidade com estes termos. 
          Qualquer tentativa de fraude ou uso indevido resultará na suspensão da conta e perda dos valores acumulados. 
          Seus dados pessoais serão tratados conforme nossa política de privacidade. 
          Ao clicar em 'Aceitar Termos e Desbloquear', você confirma que leu, entendeu e concorda com todos os termos aqui descritos.
        </p>
      </div>
      <button class="main-btn" onclick="acceptTerms()" id="accept-terms-btn">
        <i class="fas fa-check-circle"></i> Aceitar Termos e Desbloquear
      </button>

      <div class="divider"></div>

      <h2 class="section-title">Pagamento para Ativação</h2>
      <div class="payment-container" id="payment-container" style="display: none;">
        <div class="info-row">
          <span>Valor a Pagar:</span>
          <span id="payment-value">R$ 0,00</span>
        </div>
        <div class="info-row">
          <span>Forma de Pagamento:</span>
          <span id="selected-payment">Selecione uma opção</span>
        </div>
        
        <h3 class="section-title">Selecione a Forma de Pagamento</h3>
        
        <div class="payment-options">
          <div class="payment-option" onclick="selectPayment('pix')">
            <i class="fas fa-qrcode" style="font-size: 2rem; margin-bottom: 10px;"></i>
            <p>PIX</p>
          </div>
          
          <div class="payment-option" onclick="selectPayment('credit')">
            <i class="fas fa-credit-card" style="font-size: 2rem; margin-bottom: 10px;"></i>
            <p>Cartão de Crédito</p>
          </div>
          
          <div class="payment-option" onclick="selectPayment('boleto')">
            <i class="fas fa-barcode" style="font-size: 2rem; margin-bottom: 10px;"></i>
            <p>Boleto</p>
          </div>
        </div>
        
        <div id="pix-payment" class="payment-form" style="display: none;">
          <div class="highlight-box">
            <p><i class="fas fa-info-circle"></i> Pagamento instantâneo e seguro via PIX</p>
          </div>
          
          <div style="text-align: center; margin: 20px 0;">
            <div id="pix-qrcode" style="width: 200px; height: 200px; background: #fff; margin: 0 auto; display: flex; justify-content: center; align-items: center; border-radius: 10px;">
              <span style="color: #000;">QR Code PIX</span>
            </div>
            <p style="margin-top: 15px; font-size: 0.9rem;">Escaneie o QR Code com seu app bancário</p>
          </div>
          
          <div class="form-group">
            <label for="pix-key">Chave PIX (CPF/CNPJ):</label>
            <input type="text" id="pix-key" placeholder="000.000.000-00" disabled value="22.333.444/0001-55">
          </div>
          
          <button class="calculate-btn" onclick="simulatePayment('pix')">
            <i class="fas fa-check"></i> Simular Pagamento PIX
          </button>
        </div>
        
        <div id="credit-payment" class="payment-form" style="display: none;">
          <div class="highlight-box">
            <p><i class="fas fa-info-circle"></i> Pagamento seguro com cartão de crédito</p>
          </div>
          
          <div class="form-group">
            <label for="card-number">Número do Cartão:</label>
            <input type="text" id="card-number" placeholder="0000 0000 0000 0000">
          </div>
          
          <div style="display: flex; gap: 15px;">
            <div class="form-group" style="flex: 1;">
              <label for="card-expiry">Validade:</label>
              <input type="text" id="card-expiry" placeholder="MM/AA">
            </div>
            
            <div class="form-group" style="flex: 1;">
              <label for="card-cvv">CVV:</label>
              <input type="text" id="card-cvv" placeholder="000">
            </div>
          </div>
          
          <div class="form-group">
            <label for="card-name">Nome no Cartão:</label>
            <input type="text" id="card-name" placeholder="Como está no cartão">
            </div>
          
          <div class="form-group">
            <label for="card-cpf">CPF do Titular:</label>
            <input type="text" id="card-cpf" placeholder="000.000.000-00">
          </div>
          
          <button class="calculate-btn" onclick="simulatePayment('credit')">
            <i class="fas fa-check"></i> Simular Pagamento com Cartão
          </button>
        </div>
        
        <div id="boleto-payment" class="payment-form" style="display: none;">
          <div class="highlight-box">
            <p><i class="fas fa-info-circle"></i> Boleto bancário - pagável em qualquer banco</p>
          </div>
          
          <div style="text-align: center; margin: 20px 0;">
            <div id="boleto-code" style="background: #fff; color: #000; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 0.9rem;">
              23793.38128 60000.000005 00000.000000 1 83620000010000
            </div>
            <p style="margin-top: 15px; font-size: 0.9rem;">Vencimento: 10/12/2023</p>
          </div>
          
          <button class="calculate-btn" onclick="simulatePayment('boleto')">
            <i class="fas fa-check"></i> Simular Pagamento com Boleto
          </button>
        </div>
      </div>

      <div class="dashboard" id="dashboard">
        <h2 class="section-title">Dashboard do Usuário</h2>
        
        <div class="user-info">
          <h3>Olá, <span id="user-name">Usuário</span> <span class="status-badge status-active" id="user-status">Ativo</span></h3>
          <p>Email: <span id="user-email">usuario@email.com</span></p>
          <p>ID do Cliente: <span id="user-id">001</span></p>
        </div>
        
        <div class="dashboard-cards">
          <div class="dashboard-card">
            <h3><i class="fas fa-wallet"></i> Saldo Disponível</h3>
            <div class="dashboard-value" id="available-balance">R$ 0,00</div>
            <p>Valor disponível para resgate</p>
          </div>
          
          <div class="dashboard-card">
            <h3><i class="fas fa-chart-line"></i> Rendimentos Acumulados</h3>
            <div class="dashboard-value" id="total-earnings">R$ 0,00</div>
            <p>Total já ganho com o GPS</p>
          </div>
          
          <div class="dashboard-card">
            <h3><i class="fas fa-road"></i> KM Percorridos</h3>
            <div class="dashboard-value" id="total-km">0 KM</div>
            <p>Distância percorrida usando o GPS</p>
          </div>
        </div>
        
        <div class="withdrawal-info">
          <h3 class="section-title">Acessar GPS Premium</h3>
          <p>Seu GPS Premium está ativo e pronto para uso. Clique no botão abaixo para acessar o sistema de navegação.</p>
          
          <div style="text-align: center; margin: 30px 0;">
            <a class="main-btn" onclick="accessGPS()">
              <i class="gpsavz.html"></i> Acessar GPS Agora
            </a>
          </div>
          
          <div class="highlight-box">
            <p><i class="fas fa-info-circle"></i> Dica: Use o GPS diariamente para maximizar seus rendimentos!</p>
          </div>
        </div>
      </div>

      <div class="divider"></div>
      
      <a class="main-btn" onclick="showPayment()" id="purchase-btn">
        <i class="fas fa-wallet"></i> Adquirir AVZ para GPS Premium
      </a>

      <div class="divider"></div>
    </div>
  </main>

  <!-- Modal de Login/Registro -->
  <div class="modal" id="auth-modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeAuthModal()">&times;</span>
      <h2 class="section-title">Acessar Sistema</h2>
      
      <div class="auth-tabs">
        <div class="auth-tab active" onclick="switchAuthTab('login')">Entrar</div>
        <div class="auth-tab" onclick="switchAuthTab('register')">Cadastrar</div>
      </div>
      
      <div class="auth-form">
        <div id="login-form" class="auth-form-content active">
          <div class="form-group">
            <label for="login-email">Email:</label>
            <input type="email" id="login-email" placeholder="Seu email cadastrado">
          </div>
          
          <div class="form-group">
            <label for="login-password">Senha:</label>
            <input type="password" id="login-password" placeholder="Sua senha">
          </div>
          
          <button class="calculate-btn" onclick="login()">
            <i class="fas fa-sign-in-alt"></i> Entrar
          </button>
          
          <div class="form-footer">
            <p>Esqueceu sua senha? <a href="#" style="color: var(--gold);">Clique aqui</a></p>
          </div>
        </div>
        
        <div id="register-form" class="auth-form-content">
          <div class="form-group">
            <label for="register-name">Nome Completo:</label>
            <input type="text" id="register-name" placeholder="Seu nome completo">
          </div>
          
          <div class="form-group">
            <label for="register-email">Email:</label>
            <input type="email" id="register-email" placeholder="Seu melhor email">
          </div>
          
          <div class="form-group">
            <label for="register-phone">Telefone:</label>
            <input type="text" id="register-phone" placeholder="(XX) XXXXX-XXXX">
          </div>
          
          <div class="form-group">
            <label for="register-password">Senha:</label>
            <input type="password" id="register-password" placeholder="Crie uma senha segura">
          </div>
          
          <div class="form-group">
            <label for="register-confirm">Confirmar Senha:</label>
            <input type="password" id="register-confirm" placeholder="Confirme sua senha">
          </div>
          
          <button class="calculate-btn" onclick="register()">
            <i class="fas fa-user-plus"></i> Cadastrar
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
  // Configuração do servidor local
  const API_BASE = 'http://localhost:3000/api';
  let currentUser = null;
  let token = localStorage.getItem('avz_token');
  let selectedPaymentMethod = '';
  let contributionValue = 0;

  // Verificar autenticação ao carregar a página
  document.addEventListener('DOMContentLoaded', function() {
    if (token) {
      checkAuth();
    }
  });

  // Função para verificar autenticação
  async function checkAuth() {
    try {
      const response = await fetch(`${API_BASE}/user`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      
      if (response.ok) {
        const data = await response.json();
        currentUser = data.user;
        updateUI();
        
        // Se o usuário está ativo, mostrar dashboard
        if (currentUser.isActive) {
          showDashboard();
        }
      } else {
        localStorage.removeItem('avz_token');
        token = null;
      }
    } catch (error) {
      console.error('Erro ao verificar autenticação:', error);
    }
  }

  // Função para atualizar a interface
function updateUI() {
  if (currentUser) {
    document.getElementById('login-link').style.display = 'none';
    document.getElementById('dashboard-link').style.display = 'inline-block';
    document.getElementById('logout-link').style.display = 'inline-block';
    document.getElementById('purchase-btn').style.display = 'inline-block';
    
    // Atualizar informações do usuário no dashboard - COM VERIFICAÇÃO DE SEGURANÇA
    document.getElementById('user-name').textContent = currentUser.name || 'Usuário';
    document.getElementById('user-email').textContent = currentUser.email || 'N/A';
    
    // Garantir que o ID sempre tenha um valor
    const userId = currentUser.id || currentUser.userId || '000000';
    document.getElementById('user-id').textContent = userId.toString().padStart(6, '0');
    
    // Valores padrão para evitar undefined
    const balance = currentUser.balance || currentUser.saldo || 0;
    const totalEarnings = currentUser.total_earnings || currentUser.totalEarnings || 0;
    const totalKm = currentUser.total_km || currentUser.totalKm || 0;
    const isActive = currentUser.isActive || currentUser.is_active || false;
    
    document.getElementById('available-balance').textContent = `R$ ${balance.toFixed(2)}`;
    document.getElementById('total-earnings').textContent = `R$ ${totalEarnings.toFixed(2)}`;
    document.getElementById('total-km').textContent = `${totalKm} KM`;
    
    if (isActive) {
      document.getElementById('user-status').textContent = 'Ativo';
      document.getElementById('user-status').className = 'status-badge status-active';
    } else {
      document.getElementById('user-status').textContent = 'Inativo';
      document.getElementById('user-status').className = 'status-badge status-inactive';
    }
  } else {
    document.getElementById('login-link').style.display = 'inline-block';
    document.getElementById('dashboard-link').style.display = 'none';
    document.getElementById('logout-link').style.display = 'none';
    document.getElementById('purchase-btn').style.display = 'none';
    document.getElementById('dashboard').style.display = 'none';
  }
}

  // Função para mostrar o modal de autenticação
  function showAuthModal() {
    document.getElementById('auth-modal').style.display = 'flex';
  }

  // Função para fechar o modal de autenticação
  function closeAuthModal() {
    document.getElementById('auth-modal').style.display = 'none';
  }

  // Alternar entre abas de login e registro
  function switchAuthTab(tab) {
    document.querySelectorAll('.auth-tab').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.auth-form-content').forEach(el => el.classList.remove('active'));
    
    if (tab === 'login') {
      document.querySelector('.auth-tab:nth-child(1)').classList.add('active');
      document.getElementById('login-form').classList.add('active');
    } else {
      document.querySelector('.auth-tab:nth-child(2)').classList.add('active');
      document.getElementById('register-form').classList.add('active');
    }
  }

  // Função de login
  async function login() {
    const email = document.getElementById('login-email').value;
    const password = document.getElementById('login-password').value;
    
    try {
      const response = await fetch(`${API_BASE}/login`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ email, password })
      });
      
      const data = await response.json();
      
      if (response.ok) {
        token = data.token;
        localStorage.setItem('avz_token', token);
        currentUser = data.user;
        closeAuthModal();
        updateUI();
      } else {
        alert("Erro ao fazer login: " + data.error);
      }
    } catch (error) {
      alert("Erro ao fazer login: " + error.message);
    }
  }

  // Função de registro
  async function register() {
    const name = document.getElementById('register-name').value;
    const email = document.getElementById('register-email').value;
    const phone = document.getElementById('register-phone').value;
    const password = document.getElementById('register-password').value;
    const confirmPassword = document.getElementById('register-confirm').value;
    
    if (password !== confirmPassword) {
      alert("As senhas não coincidem!");
      return;
    }
    
    try {
      const response = await fetch(`${API_BASE}/register`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ name, email, phone, password })
      });
      
      const data = await response.json();
      
      if (response.ok) {
        token = data.token;
        localStorage.setItem('avz_token', token);
        currentUser = data.user;
        closeAuthModal();
        alert("Cadastro realizado com sucesso!");
        updateUI();
      } else {
        alert("Erro ao criar conta: " + data.error);
      }
    } catch (error) {
      alert("Erro ao criar conta: " + error.message);
    }
  }

  // Função de logout
  function logout() {
    token = null;
    currentUser = null;
    localStorage.removeItem('avz_token');
    alert("Logout realizado com sucesso!");
    updateUI();
  }

  // Função para mostrar o dashboard
  async function showDashboard() {
    try {
      const response = await fetch(`${API_BASE}/dashboard`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      
      if (response.ok) {
        const data = await response.json();
        currentUser = data.user;
        
        // Atualizar informações do dashboard
        document.getElementById('user-name').textContent = currentUser.name;
        document.getElementById('user-email').textContent = currentUser.email;
        document.getElementById('user-id').textContent = currentUser.id.toString().padStart(6, '0');
        document.getElementById('available-balance').textContent = `R$ ${currentUser.balance.toFixed(2)}`;
        document.getElementById('total-earnings').textContent = `R$ ${currentUser.total_earnings.toFixed(2)}`;
        document.getElementById('total-km').textContent = `${currentUser.total_km} KM`;
        
        if (currentUser.isActive) {
          document.getElementById('user-status').textContent = 'Ativo';
          document.getElementById('user-status').className = 'status-badge status-active';
        } else {
          document.getElementById('user-status').textContent = 'Inativo';
          document.getElementById('user-status').className = 'status-badge status-inactive';
        }
        
        document.getElementById('dashboard').style.display = 'block';
        window.scrollTo(0, document.getElementById('dashboard').offsetTop);
      }
    } catch (error) {
      console.error('Erro ao carregar dashboard:', error);
    }
  }

  // Função para calcular ganhos
  async function calculateEarnings() {
    const contribution = parseFloat(document.getElementById('contribution-value').value);
    const usageDays = parseInt(document.getElementById('usage-days').value);
    
    if (isNaN(contribution) || contribution < 100) {
      alert("Por favor, insira um valor de contribuição válido (mínimo R$ 100,00)");
      return;
    }
    
    if (isNaN(usageDays) || usageDays < 1 || usageDays > 7) {
      alert("Por favor, insira um número válido de dias de uso (1-7)");
      return;
    }
    
    contributionValue = contribution;
    
    try {
      const response = await fetch(`${API_BASE}/calculate`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        },
        body: JSON.stringify({ contribution, usageDays })
      });
      
      const data = await response.json();
      
      if (response.ok) {
        // Atualizar a interface
        document.getElementById('contribution-display').textContent = `R$ ${contribution.toFixed(2)}`;
        document.getElementById('monthly-return').textContent = `R$ ${data.monthlyReturn}`;
        document.getElementById('total-return').textContent = `R$ ${data.totalReturn}`;
        document.getElementById('return-percentage').textContent = `${data.returnPercentage}%`;
        
        // Atualizar barra de progresso
        const progressBar = document.getElementById('progress-bar');
        const progressValue = Math.min(parseFloat(data.returnPercentage), 100);
        
        progressBar.style.width = `${progressValue}%`;
        document.getElementById('progress-text').textContent = `${progressValue.toFixed(2)}%`;
        
        // Mostrar resultados
        document.getElementById('result-box').style.display = 'block';
        
        // Mostrar termos
        document.getElementById('terms-container').style.display = 'block';
      } else {
        alert("Erro ao calcular: " + data.error);
      }
    } catch (error) {
      alert("Erro ao calcular: " + error.message);
    }
  }

  // Função para aceitar termos
  function acceptTerms() {
    if (contributionValue === 0) {
      alert("Por favor, calcule primeiro sua antecipação antes de aceitar os termos.");
      return;
    }
    
    document.getElementById('payment-value').textContent = `R$ ${contributionValue.toFixed(2)}`;
    document.getElementById('payment-container').style.display = 'block';
    
    // Rolar para a seção de pagamento
    window.scrollTo(0, document.getElementById('payment-container').offsetTop);
  }

  // Função para selecionar método de pagamento
  function selectPayment(method) {
    selectedPaymentMethod = method;
    
    // Remover seleção anterior
    document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('selected'));
    
    // Adicionar seleção atual
    document.querySelector(`.payment-option:nth-child(${method === 'pix' ? 1 : method === 'credit' ? 2 : 3})`).classList.add('selected');
    
    // Atualizar texto
    document.getElementById('selected-payment').textContent = method === 'pix' ? 'PIX' : method === 'credit' ? 'Cartão de Crédito' : 'Boleto Bancário';
    
    // Ocultar todos os formulários
    document.querySelectorAll('.payment-form').forEach(el => el.style.display = 'none');
    
    // Mostrar formulário selecionado
    document.getElementById(`${method}-payment`).style.display = 'block';
  }

  // Função para simular pagamento
  async function simulatePayment(method) {
    if (!currentUser) {
      alert("Por favor, faça login antes de simular o pagamento.");
      return;
    }
    
    try {
      // Primeiro simular o pagamento
      const paymentResponse = await fetch(`${API_BASE}/simulate-payment`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        },
        body: JSON.stringify({ method })
      });
      
      const paymentData = await paymentResponse.json();
      
      if (!paymentResponse.ok) {
        alert("Erro no pagamento: " + paymentData.error);
        return;
      }
      
      // Ativar a conta
      const activationResponse = await fetch(`${API_BASE}/activate`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        },
        body: JSON.stringify({ contribution: contributionValue })
      });
      
      const activationData = await activationResponse.json();
      
      if (activationResponse.ok) {
        alert(`Pagamento via ${method.toUpperCase()} simulado com sucesso! Sua conta foi ativada.`);
        document.getElementById('payment-container').style.display = 'none';
        
        // Recarregar dados do usuário
        currentUser.balance = activationData.balance;
        currentUser.isActive = true;
        
        // Mostrar dashboard
        showDashboard();
      } else {
        alert("Erro ao ativar conta: " + activationData.error);
      }
    } catch (error) {
      alert("Erro ao processar pagamento: " + error.message);
    }
  }

  // Função para acessar o GPS
// Função para acessar o GPS (somente clientes ativos e pagos)
function accessGPS() {
  if (!currentUser) {
    alert("Você precisa estar logado para acessar o GPS.");
    showAuthModal();
    return;
  }

  // Carregar dados do Firestore para checar status atualizado
  db.collection('users').doc(currentUser.uid).get()
    .then((doc) => {
      if (doc.exists) {
        const userData = doc.data();
        
        if (!userData || !userData.isActive) {
          alert("Seu pagamento ainda não foi confirmado. Ative sua conta para continuar.");
          return;
        }

        if (!currentUser.uid) {
          alert("Seu cadastro não está completo. Finalize o registro.");
          return;
        }

        // ✅ Se tudo certo → liberar GPS
        alert("Acesso liberado! Redirecionando para o GPS Premium...");
        window.location.href = "gpsavz.html";
      } else {
        alert("Usuário não encontrado. Faça login novamente.");
        logout();
      }
    })
    .catch((error) => {
      console.error("Erro ao verificar status do usuário:", error);
      alert("Erro ao verificar seus dados. Tente novamente.");
    });
}


  // Função para mostrar a calculadora
  function showCalculator() {
    window.scrollTo(0, document.getElementById('calculator').offsetTop);
  }

  // Função para mostrar pagamento
  function showPayment() {
    if (!currentUser) {
      alert("Por favor, faça login antes de adquirir o GPS Premium.");
      showAuthModal();
      return;
    }
    
    window.scrollTo(0, document.getElementById('calculator').offsetTop);
  }

  // Fechar modal ao clicar fora dele
  window.onclick = function(event) {
    const modal = document.getElementById('auth-modal');
    if (event.target === modal) {
      closeAuthModal();
    }
  }

  </script>

  <footer>
    <p>&copy; 2023 AVZ PropTech - Todos os direitos reservados.</p>
  </footer>
</body>
</html>
