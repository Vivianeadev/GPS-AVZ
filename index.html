<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AVZ PropTech - GPS Premium</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <style>
  #map-in-modal {
    width: 100%;
}
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --black: #0a0a0a; --dark-black: #000000;
      --gold: #d4af37; --light-gold: #f4e4bc;
      --rose-gold: #e8b4b8; --white: #ffffff;
      --green: #4caf50; --red: #f44336;
      --rose-shadow: rgba(232, 180, 184, 0.5);
    }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #000 0%, #111 50%, #000 100%);
      color: var(--white);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    header {
      width: 100%;
      padding: 15px 0;
      display: flex;
      justify-content: center;
      background: rgba(0,0,0,0.6);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    nav {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
    }
    nav a {
      color: var(--white);
      text-decoration: none;
      font-weight: 500;
      transition: 0.3s;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(232, 180, 184, 0.2);
    }
    nav a:hover {
      color: var(--gold);
      background: rgba(212, 175, 55, 0.1);
      box-shadow: 0 0 10px var(--rose-shadow);
    }
    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      margin: 20px 0;
      background: linear-gradient(135deg, var(--gold), var(--rose-gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: center;
    }
    p.subtitle {
      font-size: 1.2rem;
      color: rgba(255,255,255,0.8);
      margin-bottom: 30px;
      text-align: center;
      max-width: 600px;
      line-height: 1.5;
    }
    .main-btn {
      display: inline-block;
      background: linear-gradient(135deg, var(--gold), var(--light-gold));
      color: var(--black);
      font-size: 1.2rem;
      font-weight: bold;
      padding: 15px 35px;
      border-radius: 50px;
      text-decoration: none;
      margin-bottom: 30px;
      transition: 0.3s;
      cursor: pointer;
      box-shadow: 0 8px 20px var(--rose-shadow), 0 0 10px var(--rose-shadow);
      text-align: center;
    }
    .main-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 28px var(--rose-shadow), 0 0 15px var(--rose-shadow);
    }
    .divider {
      width: 80%;
      max-width: 600px;
      height: 2px;
      margin: 20px auto;
      background: linear-gradient(90deg, var(--rose-gold), var(--gold), var(--rose-gold));
      border-radius: 2px;
    }
    footer {
      margin-top: 40px;
      padding: 15px 0;
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.6);
      text-align: center;
      width: 100%;
    }
    .content {
      text-align: left;
      max-width: 1000px;
      width: 100%;
      margin: 20px 0;
    }
    .hero-section {
      text-align: center;
      padding: 40px 20px;
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      border: 1px solid var(--gold);
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: var(--gold);
      margin: 25px 0 15px 0;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(212, 175, 55, 0.3);
    }
    .section-content {
      margin-bottom: 25px;
      line-height: 1.6;
    }
    .section-content p {
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.85);
    }
    .highlight-box {
      background: rgba(212, 175, 55, 0.1);
      border-left: 4px solid var(--gold);
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }
    .how-it-works {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
    }
    .step-card {
      flex: 1;
      min-width: 250px;
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 8px var(--rose-shadow);
    }
    .step-number {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--gold), var(--light-gold));
      color: var(--black);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-weight: bold;
      box-shadow: 0 4px 10px var(--rose-shadow);
    }
    .step-title {
      font-weight: 600;
      color: var(--gold);
      margin-bottom: 10px;
    }
    .calculator {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--light-gold);
    }
    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #222;
      color: white;
      font-size: 1rem;
      transition: all 0.3s;
      box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    }
    .form-group input:focus {
      outline: none;
      border-color: var(--rose-gold);
      box-shadow: 0 0 10px var(--rose-shadow);
    }
    .calculate-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--gold), var(--light-gold));
      color: var(--black);
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 1.1rem;
      box-shadow: 0 6px 15px var(--rose-shadow), 0 0 10px var(--rose-shadow);
      margin-bottom: 20px;
    }
    .calculate-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px var(--rose-shadow), 0 0 15px var(--rose-shadow);
    }
    .result-box {
      background: rgba(0, 0, 0, 0.3);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .result-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--light-gold);
      margin: 10px 0;
    }
    .terms-container {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
      max-height: 200px;
      overflow-y: auto;
    }
    .terms-text {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.5;
    }
    main {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 1200px;
    }
    .withdrawal-info {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
    }
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .info-card {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 20px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .info-card h3 {
      color: var(--gold);
      margin-bottom: 15px;
    }
    .warning-box {
      background: rgba(244, 67, 54, 0.1);
      border-left: 4px solid var(--red);
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }
    .benefits-list {
      list-style-type: none;
      margin: 20px 0;
    }
    .benefits-list li {
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
    }
    .benefits-list li i {
      color: var(--gold);
      margin-right: 10px;
    }
    .progress-container {
      width: 100%;
      height: 20px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      margin: 20px 0;
      overflow: hidden;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--gold), var(--rose-gold));
      border-radius: 10px;
      width: 0%;
      transition: width 0.5s ease;
    }
    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .info-row:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 100;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: rgba(30, 30, 30, 0.95);
      border-radius: 15px;
      padding: 30px;
      border: 2px solid var(--gold);
      width: 90%;
      max-width: 450px;
      position: relative;
    }
    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: var(--white);
      font-size: 1.5rem;
      cursor: pointer;
    }
    .auth-form {
      margin-top: 20px;
    }
    .auth-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(212, 175, 55, 0.3);
    }
    .auth-tab {
      padding: 10px 20px;
      cursor: pointer;
      opacity: 0.7;
      transition: 0.3s;
      box-shadow: 0 2px 5px rgba(232, 180, 184, 0.1);
    }
    .auth-tab.active {
      opacity: 1;
      border-bottom: 2px solid var(--gold);
      color: var(--gold);
      box-shadow: 0 2px 5px var(--rose-shadow);
    }
    .auth-form-content {
      display: none;
    }
    .auth-form-content.active {
      display: block;
    }
    .form-footer {
      margin-top: 20px;
      text-align: center;
      font-size: 0.9rem;
    }
    .payment-container {
      background: rgba(30, 30, 30, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid var(--gold);
      margin: 30px 0;
      display: none;
    }
    .payment-options {
      display: flex;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .payment-option {
      flex: 1;
      min-width: 120px;
      padding: 15px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 4px 10px rgba(232, 180, 184, 0.2);
    }
    .payment-option.selected {
      background: rgba(212, 175, 55, 0.1);
      border-color: var(--gold);
      box-shadow: 0 0 10px var(--rose-shadow);
    }
    .payment-form {
      margin-top: 20px;
      display: none;
    }
    .card-element {
      background: #222;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #444;
      margin-bottom: 20px;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
    }
    .dashboard {
      display: none;
      width: 100%;
    }
    .projection-box {
      background: rgba(212, 175, 55, 0.1);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 20px;
      text-align: center;
      font-size: 0.9em;
      box-shadow: 0 4px 10px rgba(232, 180, 184, 0.2);
    }
    .projection-box strong {
      color: var(--light-gold);
    }
    .map-and-directions-wrapper {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    #map {
      flex: 3;
      height: 60vh;
      min-width: 300px;
      border-radius: 10px;
      border: 1px solid var(--gold);
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    }
    #directions-panel {
      flex: 1;
      min-width: 250px;
      background: #111;
      padding: 15px;
      border-radius: 10px;
      max-height: 60vh;
      overflow-y: auto;
      font-size: 0.9em;
      line-height: 1.5;
      border: 1px solid rgba(212, 175, 55, 0.3);
      color: rgba(255, 255, 255, 0.85);
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    }
    #directions-panel strong {
      color: var(--gold);
      display: block;
      margin-bottom: 10px;
    }
    #directions-panel ol, #directions-panel li {
      margin: 0;
      padding: 0;
      list-style-type: decimal;
      margin-left: 20px;
    }
    #directions-panel li {
      margin-bottom: 8px;
    }
    .gps-section {
      display: none;
      width: 100%;
    }
    .input-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }
    .input-row {
      display: flex;
      gap: 10px;
    }
    .input-row input {
      flex: 1;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #222;
      color: white;
      font-size: 1rem;
      transition: all 0.3s;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
    }
    .input-row input:focus {
      outline: none;
      border-color: var(--rose-gold);
      box-shadow: 0 0 10px var(--rose-shadow);
    }
    .input-row button {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      background: var(--gold);
      color: var(--black);
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
      box-shadow: 0 4px 10px rgba(232, 180, 184, 0.2);
    }
    .input-row button:hover {
      background: var(--light-gold);
      box-shadow: 0 6px 15px var(--rose-shadow);
    }
    @media (max-width: 768px) {
      .map-and-directions-wrapper {
        flex-direction: column;
      }
      #map, #directions-panel {
        flex: none;
        width: 100%;
        min-width: unset;
      }
      #directions-panel {
        max-height: 30vh;
      }
      .input-row {
        flex-direction: column;
      }
      .input-row input, .input-row button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <a style="color: var(--gold);"><i class="fas fa-map-marked-alt"></i> AVZ PROPTECH</a>
      <div class="client-info" style="display: none;">Cliente: <span id="client-info-id"></span></div>
      <a onclick="showAuthModal()" id="login-link"><i class="fas fa-user"></i> Entrar | Cadastrar </a>
      <a onclick="showDashboard()" id="dashboard-link" style="display: none;"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
      <a onclick="logout()" id="logout-link" style="display: none;"><i class="fas fa-sign-out-alt"></i> Sair</a>
    </nav>
  </header>
  
  <main>
    <div id="gps-section" class="gps-section">
      <h1>GPS Premium AVZ</h1>
      <div class="main-container">
        <div class="info-box">
          <p>Status do GPS: <strong id="status-text">Iniciando...</strong></p>
          <p>Rendimentos acumulados: <strong id="earnings-display">R$ 0,00</strong></p>
        </div>
        <div class="projection-box">
          <p>Projeção de Ganhos em tempo real: <strong id="projected-earnings">Aguardando cálculo...</strong></p>
        </div>
        <div class="input-group">
          <div class="input-row">
            <input type="text" id="origin-input" placeholder="Opcional: Digite sua origem...">
          </div>
          <div class="input-row">
            <input type="text" id="destination-input" placeholder="Digite seu destino...">
          </div>
          <div class="input-row">
            <button onclick="calculateAndDisplayRoute()"><i class="fas fa-route"></i> Traçar Rota</button>
            <button onclick="toggleMapStyle()"><i class="fas fa-adjust"></i> Estilo de Mapa</button>
          </div>
          <div class="input-row" style="display: none;" id="route-controls">
            <button onclick="startRoute()" id="start-route-btn"><i class="fas fa-play"></i> Iniciar Rota</button>
            <button onclick="stopRoute()" id="stop-route-btn" style="display: none;"><i class="fas fa-stop"></i> Parar Rota</button>
          </div>
        </div>
        <div class="map-and-directions-wrapper">
          <div id="map"></div>
          <div id="directions-panel">
            <strong>Instruções da Rota:</strong>
          </div>
        </div>
        <div class="info-box">
          <p>Distância Total: <strong id="distance-display">N/A</strong></p>
          <p>Tempo Estimado: <strong id="duration-display">N/A</strong></p>
        </div>
      </div>
    </div>
    
    <div id="hero-section" class="hero-section">
      <h1>GPS Premium AVZ</h1>
      <p class="subtitle">Antecipe seus recebíveis e ganhe dinheiro com a sua rota. Uma plataforma **inovadora** e **segura**.</p>
      <h2>Desbloqueie seu Potencial de Ganhos</h2>
      <p class="section-content">Faça login ou cadastre-se para acessar a calculadora de antecipação e começar a ganhar com o GPS Premium AVZ.</p>
      <a class="main-btn" onclick="showAuthModal()"> Começar Agora <i class="fas fa-arrow-right"></i></a>
    </div>
    
    <div class="user-info-section" style="display: none;">
      <h2 class="section-title">Bem-vindo(a), <span id="user-name">Usuário</span>!</h2>
      <p>ID de Cliente: <strong id="user-id">000000</strong></p>
      <div class="highlight-box">
        <p><strong>Status:</strong> <span id="user-status">Inativo</span></p>
      </div>
    </div>
    
    <div class="content">
      <h2 class="section-title">Como Funciona</h2>
      <div class="how-it-works">
        <div class="step-card">
          <div class="step-number">1</div>
          <div class="step-title">Calcule sua Antecipação</div>
          <p>Informe seus dados e veja quanto poderá receber.</p>
        </div>
        <div class="step-card">
          <div class="step-number">2</div>
          <div class="step-title">Desbloqueie o GPS</div>
          <p>Concorde com os termos e desbloqueie o sistema.</p>
        </div>
        <div class="step-card">
          <div class="step-number">3</div>
          <div class="step-title">Use e Ganhe</div>
          <p>Use o GPS diariamente e acumule rendimentos.</p>
        </div>
        <div class="step-card">
          <div class="step-number">4</div>
          <div class="step-title">Resgate seus Ganhos</div>
          <p>Resgate a partir de R$ 100,00 a qualquer momento.</p>
        </div>
      </div>
      <div class="divider"></div>
      
      <h2 class="section-title" id="calculator-title" style="display: none;">Calculadora de Antecipação</h2>
      <div class="calculator" id="calculator" style="display: none;">
        <div class="form-group">
          <label for="contribution-value">Valor da Contribuição (R$ 30,00 a R$ 300,00):</label>
          <input type="number" id="contribution-value" placeholder="Ex: 50.00" min="30" max="300">
        </div>
        <div class="form-group">
          <label for="usage-days">Dias de Uso do GPS por Semana (1-7):</label>
          <input type="number" id="usage-days" placeholder="Ex: 5" min="1" max="7">
        </div>
        <button class="calculate-btn" onclick="calculateEarnings()">
          <i class="fas fa-calculator"></i> Calcular Projeção de Ganhos
        </button>
        <div class="result-box" id="result-box" style="display: none;">
          <h3>Sua Projeção de Ganhos</h3>
          <div class="info-row">
            <span>Valor Contribuído:</span>
            <span id="contribution-display">R$ 100.00</span>
          </div>
          <div class="info-row">
            <span>Retorno Mensal Estimado:</span>
            <span id="monthly-return">R$ 3.00</span>
          </div>
          <div class="info-row">
            <span>Retorno Total Estimado (6 meses):</span>
            <span id="total-return">R$ 18.00</span>
          </div>
          <div class="info-row">
            <span>Porcentagem de Retorno:</span>
            <span id="return-percentage">18%</span>
          </div>
          <div class="info-row" style="margin-top: 10px;">
              <span>**Resgate do Bônus:**</span>
              <span style="font-weight: bold; color: var(--gold);">6 meses</span>
          </div>
          <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
            <span class="progress-text" id="progress-text">18%</span>
          </div>
          <button class="calculate-btn" onclick="continueToTerms()">
            Continuar para os Termos <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
      <div class="divider" id="divider-1" style="display: none;"></div>
      
      <h2 class="section-title" id="terms-title" style="display: none;">Termos de Uso e Desbloqueio</h2>
      <div class="terms-container" id="terms-container" style="display: none;">
        <p class="terms-text">
          Ao aceitar, você concorda em utilizar o GPS da AVZ PropTech para fins de monitoramento de rotas e contribuição para a otimização logística de projetos sustentáveis. A antecipação de recebíveis será creditada diariamente com base no uso do aplicativo. O valor mínimo para resgate é de R$ 100,00. A AVZ PropTech se reserva o direito de auditar o uso do aplicativo para garantir a legitimidade da contribuição. Qualquer uso indevido resultará na suspensão imediata da conta e na perda dos recebíveis acumulados.
        </p>
        <div class="form-group">
          <input type="checkbox" id="terms-checkbox">
          <label for="terms-checkbox" style="display: inline; margin-left: 10px;">Eu li e concordo com os Termos de Uso</label>
        </div>
        <button class="calculate-btn" onclick="aceitarTermos()"> Concordo e Desbloquear GPS </button>
      </div>
      <div class="divider" id="divider-2" style="display: none;"></div>
      
      <h2 class="section-title" id="payment-title" style="display: none;">Adquirir AVZ para GPS Premium</h2>
      <div class="payment-container" id="payment-container" style="display: none;">
        <div class="highlight-box">
          <p>O valor para desbloqueio do GPS Premium é de **R$ 1.000,00**.</p>
        </div>
        <p>Escolha a forma de pagamento:</p>
        <div class="payment-options">
          <div class="payment-option selected" id="pix-option" onclick="selectPayment('pix')">
            <i class="fas fa-qrcode"></i>
            <p>PIX</p>
          </div>
          <div class="payment-option" id="card-option" onclick="selectPayment('card')">
            <i class="fas fa-credit-card"></i>
            <p>Cartão de Crédito</p>
          </div>
          <div class="payment-option" id="boleto-option" onclick="selectPayment('boleto')">
            <i class="fas fa-barcode"></i>
            <p>Boleto Bancário</p>
          </div>
        </div>
        <div class="payment-form" id="pix-form" style="display: block;">
          <p>Chave PIX: **99.999.999/0001-99**</p>
          <div class="warning-box">
            <p><strong>Aviso:</strong> O pagamento via PIX é instantâneo. Após a confirmação, seu GPS será desbloqueado em até 10 minutos.</p>
          </div>
          <button class="calculate-btn" onclick="simulatePayment()">
            <i class="fas fa-check-circle"></i> Simular Pagamento
          </button>
        </div>
        <div class="payment-form" id="card-form" style="display: none;">
          <div class="warning-box">
            <p><strong>Simulação:</strong> A função de cartão de crédito não está ativa no momento. Clique no botão abaixo para simular a conclusão do pagamento e acessar o dashboard.</p>
          </div>
          <button class="calculate-btn" onclick="simulatePayment()">
            <i class="fas fa-check-circle"></i> Simular Pagamento
          </button>
        </div>
        <div class="payment-form" id="boleto-form" style="display: none;">
          <div class="warning-box">
            <p><strong>Simulação:</strong> A função de boleto não está ativa no momento. Clique no botão abaixo para simular a conclusão do pagamento e acessar o dashboard.</p>
          </div>
          <button class="calculate-btn" onclick="simulatePayment()">
            <i class="fas fa-check-circle"></i> Simular Pagamento
          </button>
        </div>
      </div>
      <div class="divider" id="divider-3" style="display: none;"></div>
      
      <h2 class="section-title" id="dashboard-title" style="display: none;">Seu Dashboard</h2>
      <div class="dashboard" id="dashboard" style="display: none;">
        <div class="hero-section">
          <h2>Seus Rendimentos Acumulados</h2>
          <p class="subtitle">Acompanhe seu progresso e faça resgates.</p>
          <div class="result-box">
            <h3>Valor Acumulado</h3>
            <span class="result-value" id="accumulated-earnings">R$ 0.00</span>
          </div>
        </div>
        <div class="info-grid">
          <div class="info-card">
            <button class="main-btn" style="margin-top: 20px;" onclick="checkGPSAccess()">
              <i class="fas fa-map-marked-alt"></i> Acessar GPS Premium
            </button>
            <h3>Ganhos Diários</h3>
            <p>Média de **R$ 0,50** por dia de uso do GPS.</p>
          </div>
          <div class="info-card">
            <h3>Último Resgate</h3>
            <p>Ainda não há resgates. <br>Valor mínimo: **R$ 100,00**</p>
          </div>
        </div>
        <div class="divider"></div>
        <h2 class="section-title">Benefícios do GPS Premium</h2>
        <ul class="benefits-list">
          <li><i class="fas fa-route"></i> Otimização de rotas com IA.</li>
          <li><i class="fas fa-dollar-sign"></i> Antecipação de recebíveis diária.</li>
          <li><i class="fas fa-chart-line"></i> Acompanhamento de rendimentos em tempo real.</li>
          <li><i class="fas fa-shield-alt"></i> Segurança avançada para seus dados.</li>
        </ul>
      </div>
    </div>
  </main>
  
  <div id="auth-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeAuthModal()">×</span>
      <h2 class="section-title" style="margin-top: 0;">Entrar ou Cadastrar</h2>
      <div class="auth-tabs">
        <div class="auth-tab active" id="login-tab" onclick="showAuthForm('login')">Entrar</div>
        <div class="auth-tab" id="register-tab" onclick="showAuthForm('register')">Cadastrar</div>
      </div>
      <div class="auth-form-content active" id="login-form">
        <p>Acesse sua conta para continuar.</p>
        <div class="form-group">
          <label for="login-email">Email:</label>
          <input type="email" id="login-email" placeholder="seu-email@exemplo.com">
        </div>
        <div class="form-group">
          <label for="login-password">Senha:</label>
          <input type="password" id="login-password" placeholder="••••••••">
        </div>
        <button class="calculate-btn" onclick="login()">Entrar</button>
      </div>
      <div class="auth-form-content" id="register-form">
        <p>Crie sua conta para começar.</p>
        <div class="form-group">
          <label for="register-name">Nome Completo:</label>
          <input type="text" id="register-name" placeholder="Seu Nome Completo">
        </div>
        <div class="form-group">
          <label for="register-email">Email:</label>
          <input type="email" id="register-email" placeholder="seu-email@exemplo.com">
        </div>
        <div class="form-group">
          <label for="register-password">Senha:</label>
          <input type="password" id="register-password" placeholder="Mínimo 6 caracteres">
        </div>
        <button class="calculate-btn" onclick="register()">Cadastrar</button>
      </div>
    </div>
  </div>

  <div id="map-modal" class="modal">
    <div class="modal-content" style="max-width: 90%;">
      <span class="close-modal" onclick="closeMapModal()">×</span>
      <h2 class="section-title">Mapa AVZ PropTech</h2>
      <div id="map-in-modal" style="height: 75vh; border-radius: 10px; border: 1px solid var(--gold);"></div>
    </div>
  </div>

  <script>
    const TEST_USER = {
      name: "Cliente de Teste",
      email: "teste@avz.com",
      id: 556135,
      isActive: false,
      earnings: 0
    };
    let currentUser = null;
    let token = localStorage.getItem('avz_token');
    let map;
    let marker;
    let locationCircle;
    let otherVehicles = [];
    let watchId;
    let userId;
    let directionsService;
    let directionsRenderer;
    let projectionIntervalId;
    let earningsIntervalId;
    let isDarkStyle = true;
    let routeSimulationIntervalId;
    let routePath;
    let routeStep = 0;
    const otherVehicleMarkers = [];
    let originPlace;
    let destinationPlace;

    function showAuthModal() {
      document.getElementById('auth-modal').style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeAuthModal() {
      document.getElementById('auth-modal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function showAuthForm(formId) {
      document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.auth-form-content').forEach(content => content.classList.remove('active'));
      document.getElementById(`${formId}-tab`).classList.add('active');
      document.getElementById(`${formId}-form`).classList.add('active');
    }

    function getUserIdFromToken() {
      const token = localStorage.getItem('avz_token');
      if (token) {
        try {
          const user = JSON.parse(atob(token));
          return user.id;
        } catch (e) {
          localStorage.removeItem('avz_token');
          return null;
        }
      }
      return null;
    }

    function updateUserStatus() {
      if (currentUser) {
        document.querySelector('.user-info-section').style.display = 'block';
        document.getElementById('user-name').textContent = currentUser.name;
        document.getElementById('user-id').textContent = currentUser.id;
        document.getElementById('user-status').textContent = currentUser.isActive ? 'Ativo' : 'Inativo';
        document.getElementById('login-link').style.display = 'none';
        document.getElementById('dashboard-link').style.display = 'inline-block';
        document.getElementById('logout-link').style.display = 'inline-block';
        document.getElementById('hero-section').style.display = 'none';
        document.getElementById('gps-section').style.display = currentUser.isActive ? 'block' : 'none';
        document.getElementById('calculator-title').style.display = currentUser.isActive ? 'none' : 'block';
        document.getElementById('calculator').style.display = currentUser.isActive ? 'none' : 'block';
        document.getElementById('terms-title').style.display = 'none';
        document.getElementById('terms-container').style.display = 'none';
        document.getElementById('payment-title').style.display = 'none';
        document.getElementById('payment-container').style.display = 'none';
        
        if (currentUser.isActive) {
           document.getElementById('dashboard').style.display = 'block';
           document.getElementById('dashboard-title').style.display = 'block';
           document.getElementById('accumulated-earnings').textContent = `R$ ${currentUser.earnings.toFixed(2)}`;
        }
      }
    }

    function login() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      if (email === TEST_USER.email && password === '123456') {
        const tokenData = { name: TEST_USER.name, id: TEST_USER.id, isActive: TEST_USER.isActive, earnings: TEST_USER.earnings };
        token = btoa(JSON.stringify(tokenData));
        localStorage.setItem('avz_token', token);
        currentUser = tokenData;
        updateUserStatus();
        closeAuthModal();
      } else {
        alert('Email ou senha incorretos.');
      }
    }

    function register() {
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      
      if (name && email && password.length >= 6) {
        const newUser = { name, email, id: Math.floor(Math.random() * 1000000), isActive: false, earnings: 0 };
        const tokenData = btoa(JSON.stringify(newUser));
        localStorage.setItem('avz_token', tokenData);
        currentUser = newUser;
        updateUserStatus();
        closeAuthModal();
        alert(`Cadastro realizado com sucesso! Seu ID de cliente é: ${newUser.id}`);
      } else {
        alert('Por favor, preencha todos os campos. A senha deve ter no mínimo 6 caracteres.');
      }
    }
    
    function logout() {
      localStorage.removeItem('avz_token');
      localStorage.removeItem('investmentAmount');
      localStorage.removeItem('hasCalculated');
      currentUser = null;
      document.querySelector('.user-info-section').style.display = 'none';
      document.getElementById('login-link').style.display = 'inline-block';
      document.getElementById('dashboard-link').style.display = 'none';
      document.getElementById('logout-link').style.display = 'none';
      document.getElementById('hero-section').style.display = 'block';
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('dashboard-title').style.display = 'none';
      document.getElementById('gps-section').style.display = 'none';
      document.getElementById('calculator-title').style.display = 'block';
      document.getElementById('calculator').style.display = 'block';
    }

    function showDashboard() {
      document.getElementById('hero-section').style.display = 'none';
      document.getElementById('gps-section').style.display = 'none';
      document.getElementById('calculator-title').style.display = 'none';
      document.getElementById('calculator').style.display = 'none';
      document.getElementById('terms-title').style.display = 'none';
      document.getElementById('terms-container').style.display = 'none';
      document.getElementById('payment-container').style.display = 'none';
      document.getElementById('payment-title').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      document.getElementById('dashboard-title').style.display = 'block';
      window.scrollTo(0, document.getElementById('dashboard-title').offsetTop);
      
      if (currentUser) {
        document.getElementById('accumulated-earnings').textContent = `R$ ${currentUser.earnings.toFixed(2)}`;
      }
    }
    
    function calculateEarnings() {
      const contributionValue = parseFloat(document.getElementById('contribution-value').value);
      const usageDays = parseInt(document.getElementById('usage-days').value);
      
      if (isNaN(contributionValue) || contributionValue < 30 || contributionValue > 300 || isNaN(usageDays) || usageDays < 1 || usageDays > 7) {
        alert("Por favor, insira valores válidos. O valor do investimento deve ser entre R$ 30,00 e R$ 300,00.");
        return;
      }
      
      const monthlyReturnRate = 0.03;
      const totalReturnRate = 0.18;
      
      const monthlyReturn = contributionValue * monthlyReturnRate;
      const totalReturn = contributionValue * totalReturnRate;
      const returnPercentage = totalReturnRate * 100;
      
      localStorage.setItem('investmentAmount', contributionValue);
      localStorage.setItem('hasCalculated', true);
      
      document.getElementById('contribution-display').textContent = `R$ ${contributionValue.toFixed(2)}`;
      document.getElementById('monthly-return').textContent = `R$ ${monthlyReturn.toFixed(2)}`;
      document.getElementById('total-return').textContent = `R$ ${totalReturn.toFixed(2)}`;
      document.getElementById('return-percentage').textContent = `${returnPercentage.toFixed(0)}%`;
      document.getElementById('progress-bar').style.width = `${returnPercentage.toFixed(0)}%`;
      document.getElementById('progress-text').textContent = `${returnPercentage.toFixed(0)}%`;
      
      document.getElementById('result-box').style.display = 'block';
      
      startBonusProjection(totalReturn);
    }
    
    function startBonusProjection(totalBonus) {
      if (projectionIntervalId) {
        clearInterval(projectionIntervalId);
      }
      const projectionElement = document.getElementById('projected-earnings');
      let currentProjection = 0;
      const increment = totalBonus / (60 * 10); // 10 minutos
      
      projectionIntervalId = setInterval(() => {
        currentProjection += increment;
        if (currentProjection >= totalBonus) {
          currentProjection = totalBonus;
          clearInterval(projectionIntervalId);
        }
        projectionElement.textContent = `R$ ${currentProjection.toFixed(2)}`;
      }, 1000); // Atualiza a cada segundo
    }

    function continueToTerms() {
      document.getElementById('calculator').style.display = 'none';
      document.getElementById('calculator-title').style.display = 'none';
      document.getElementById('divider-1').style.display = 'none';
      
      document.getElementById('terms-container').style.display = 'block';
      document.getElementById('terms-title').style.display = 'block';
      document.getElementById('divider-2').style.display = 'block';
      
      window.scrollTo(0, document.getElementById('terms-title').offsetTop);
    }
    
    function aceitarTermos() {
      if (!document.getElementById('terms-checkbox').checked) {
        alert('Você deve aceitar os Termos de Uso para continuar.');
        return;
      }
      
      document.getElementById('terms-container').style.display = 'none';
      document.getElementById('terms-title').style.display = 'none';
      document.getElementById('divider-2').style.display = 'none';
      
      document.getElementById('payment-container').style.display = 'block';
      document.getElementById('payment-title').style.display = 'block';
      document.getElementById('divider-3').style.display = 'block';
      
      window.scrollTo(0, document.getElementById('payment-title').offsetTop);
    }

    function simulatePayment() {
      alert("Pagamento simulado com sucesso! Seu GPS Premium foi desbloqueado.");
      
      if (currentUser) {
        currentUser.isActive = true;
        currentUser.earnings = 0;
        const tokenData = btoa(JSON.stringify(currentUser));
        localStorage.setItem('avz_token', tokenData);
        updateUserStatus();
      }
      
      document.getElementById('payment-container').style.display = 'none';
      document.getElementById('payment-title').style.display = 'none';
      document.getElementById('divider-3').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      document.getElementById('dashboard-title').style.display = 'block';
      window.scrollTo(0, document.getElementById('dashboard-title').offsetTop);
      
      if (currentUser) {
        startEarningsUpdates();
      }
    }

    function startEarningsUpdates() {
      if (earningsIntervalId) {
        clearInterval(earningsIntervalId);
      }
      
      earningsIntervalId = setInterval(() => {
        if (currentUser && currentUser.isActive) {
          const dailyRate = 0.50;
          currentUser.earnings += dailyRate;
          document.getElementById('earnings-display').textContent = `R$ ${currentUser.earnings.toFixed(2)}`;
          const tokenData = btoa(JSON.stringify(currentUser));
          localStorage.setItem('avz_token', tokenData);
        }
      }, 86400000); // Adiciona R$ 0,50 a cada 24 horas (86400000 milissegundos)
    }

    function checkGPSAccess() {
      if (currentUser && currentUser.isActive) {
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('dashboard-title').style.display = 'none';
        document.getElementById('gps-section').style.display = 'block';
        if (localStorage.getItem('investmentAmount')) {
          displayProjectedEarnings();
        }
      } else {
        alert("Você precisa desbloquear o GPS Premium para acessá-lo. Retorne ao Dashboard para continuar.");
      }
    }

    function displayProjectedEarnings() {
      const storedAmount = localStorage.getItem('investmentAmount');
      if (storedAmount) {
        const totalReturnRate = 0.18;
        const totalReturn = parseFloat(storedAmount) * totalReturnRate;
        document.getElementById('projected-earnings').textContent = `R$ ${totalReturn.toFixed(2)}`;
      } else {
        document.getElementById('projected-earnings').textContent = 'Nenhum cálculo encontrado.';
      }
    }

    function selectPayment(option) {
      document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
      document.getElementById(`${option}-option`).classList.add('selected');
      
      document.getElementById('pix-form').style.display = 'none';
      document.getElementById('card-form').style.display = 'none';
      document.getElementById('boleto-form').style.display = 'none';
      document.getElementById(`${option}-form`).style.display = 'block';
    }

    function showMapModal() {
      document.getElementById('map-modal').style.display = 'flex';
      document.body.style.overflow = 'hidden';
      // Garante que o mapa seja exibido corretamente após o modal ser aberto
      setTimeout(() => {
        google.maps.event.trigger(map, 'resize');
        if (marker) {
          map.setCenter(marker.getPosition());
        }
      }, 100);
    }
    
    function closeMapModal() {
      document.getElementById('map-modal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    window.onclick = function(event) {
      const modal = document.getElementById('auth-modal');
      const mapModal = document.getElementById('map-modal');
      if (event.target === modal) {
        closeAuthModal();
      }
      if (event.target === mapModal) {
        closeMapModal();
      }
    }
    
    // Simulação do Google Maps
    function initMap() {
      userId = getUserIdFromToken();
      const defaultLocation = { lat: -23.550520, lng: -46.633308 };
      
      const mapStyle = [ 
          { "featureType": "all", "elementType": "all", "stylers": [ { "invert_lightness": true }, { "saturation": -100 }, { "lightness": -30 }, { "gamma": 0.5 } ] }, 
          { "featureType": "water", "elementType": "all", "stylers": [ { "color": "#0a0a0a" } ] }, 
          { "featureType": "road", "elementType": "geometry.fill", "stylers": [ { "color": "#1f1f1f" } ] }, 
          { "featureType": "road", "elementType": "geometry.stroke", "stylers": [ { "color": "#d4af37" }, { "weight": 0.5 } ] }, 
          { "featureType": "transit.station.bus", "elementType": "all", "stylers": [ { "visibility": "off" } ] }, 
          { "featureType": "poi", "elementType": "all", "stylers": [ { "visibility": "off" } ] }, 
          { "featureType": "landscape.man_made", "elementType": "geometry", "stylers": [ { "color": "#111111" } ] }, 
          { "featureType": "landscape.natural", "elementType": "geometry", "stylers": [ { "color": "#111111" } ] }, 
          { "featureType": "administrative", "elementType": "geometry", "stylers": [ { "color": "#d4af37" } ] } 
      ];
      
      map = new google.maps.Map(document.getElementById("map"), {
        center: defaultLocation,
        zoom: 15,
        styles: mapStyle,
        mapTypeControl: true,
        mapTypeControlOptions: { position: google.maps.ControlPosition.TOP_RIGHT },
        streetViewControl: false,
        fullscreenControl: true
      });
      
      marker = new google.maps.Marker({
        position: defaultLocation,
        map: map,
        title: "Sua localização",
        icon: {
          path: "M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5 14.5 7.62 14.5 9s-1.12 2.5-2.5 2.5z",
          fillColor: '#d4af37',
          fillOpacity: 1,
          strokeWeight: 0,
          scale: 2,
          anchor: new google.maps.Point(12, 24)
        }
      });
      
      locationCircle = new google.maps.Circle({
        strokeColor: '#d4af37',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#d4af37',
        fillOpacity: 0.35,
        map: map,
        center: defaultLocation,
        radius: 50
      });
      
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        panel: document.getElementById('directions-panel')
      });
      
      const originInput = document.getElementById('origin-input');
      const destinationInput = document.getElementById('destination-input');
      const originAutocomplete = new google.maps.places.Autocomplete(originInput);
      const destinationAutocomplete = new google.maps.places.Autocomplete(destinationInput);
      
      originAutocomplete.addListener('place_changed', () => {
        originPlace = originAutocomplete.getPlace();
      });
      destinationAutocomplete.addListener('place_changed', () => {
        destinationPlace = destinationAutocomplete.getPlace();
      });
    }

    function toggleMapStyle() {
        if (isDarkStyle) {
            map.setOptions({
                styles: []
            });
            isDarkStyle = false;
        } else {
            const mapStyle = [ 
                { "featureType": "all", "elementType": "all", "stylers": [ { "invert_lightness": true }, { "saturation": -100 }, { "lightness": -30 }, { "gamma": 0.5 } ] }, 
                { "featureType": "water", "elementType": "all", "stylers": [ { "color": "#0a0a0a" } ] }, 
                { "featureType": "road", "elementType": "geometry.fill", "stylers": [ { "color": "#1f1f1f" } ] }, 
                { "featureType": "road", "elementType": "geometry.stroke", "stylers": [ { "color": "#d4af37" }, { "weight": 0.5 } ] }, 
                { "featureType": "transit.station.bus", "elementType": "all", "stylers": [ { "visibility": "off" } ] }, 
                { "featureType": "poi", "elementType": "all", "stylers": [ { "visibility": "off" } ] }, 
                { "featureType": "landscape.man_made", "elementType": "geometry", "stylers": [ { "color": "#111111" } ] }, 
                { "featureType": "landscape.natural", "elementType": "geometry", "stylers": [ { "color": "#111111" } ] }, 
                { "featureType": "administrative", "elementType": "geometry", "stylers": [ { "color": "#d4af37" } ] } 
            ];
            map.setOptions({
                styles: mapStyle
            });
            isDarkStyle = true;
        }
    }
    
    function calculateAndDisplayRoute() {
      const destination = document.getElementById('destination-input').value;
      if (!destination) {
        alert("Por favor, digite um destino.");
        return;
      }
      
      const origin = document.getElementById('origin-input').value;
      
      directionsService.route({
        origin: origin || marker.getPosition(),
        destination: destination,
        travelMode: 'DRIVING'
      }, (response, status) => {
        if (status === 'OK') {
          directionsRenderer.setDirections(response);
          const route = response.routes[0];
          const leg = route.legs[0];
          document.getElementById('distance-display').textContent = leg.distance.text;
          document.getElementById('duration-display').textContent = leg.duration.text;
          document.getElementById('route-controls').style.display = 'flex';
          routePath = route.overview_path;
          routeStep = 0;
        } else {
          window.alert('Falha ao traçar a rota. Status: ' + status);
        }
      });
    }

    function startRoute() {
      if (routeSimulationIntervalId) {
        clearInterval(routeSimulationIntervalId);
      }
      
      document.getElementById('start-route-btn').style.display = 'none';
      document.getElementById('stop-route-btn').style.display = 'inline-block';
      
      routeSimulationIntervalId = setInterval(() => {
        if (routeStep < routePath.length) {
          const newPosition = routePath[routeStep];
          marker.setPosition(newPosition);
          map.setCenter(newPosition);
          routeStep++;
        } else {
          stopRoute();
          alert("Chegou ao seu destino!");
        }
      }, 500); // Mova a cada 0.5 segundos para simular o movimento
    }

    function stopRoute() {
      clearInterval(routeSimulationIntervalId);
      document.getElementById('stop-route-btn').style.display = 'none';
      document.getElementById('start-route-btn').style.display = 'inline-block';
    }
    
    // Chame esta função ao carregar a página
    (function() {
      try {
        const storedUser = localStorage.getItem('avz_token');
        if (storedUser) {
          currentUser = JSON.parse(atob(storedUser));
          updateUserStatus();
        } else {
          updateUserStatus();
        }
        if (currentUser && currentUser.isActive) {
          startEarningsUpdates();
        }
      } catch (e) {
        console.error("Erro ao carregar dados do usuário:", e);
        localStorage.removeItem('avz_token');
        currentUser = null;
        updateUserStatus();
      }
    })();
  </script>
  
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7WQiZgCVhr35Zc-hTJAtIT897YhIgUE0&callback=initMap&libraries=maps,marker,places,routes"></script>
  
  <footer>
    <p>© 2025 AVZ PropTech - Todos os direitos reservados.</p>
  </footer>
  
</body>
</html>
